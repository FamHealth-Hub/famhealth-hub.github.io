<!DOCTYPE html>
<html lang="de" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Untersuchung: Akute Erkältung – Lena</title>
  <link rel="stylesheet" href="assets/css/global.css">
  <link rel="stylesheet" href="assets/css/app.css">
  <script src="https://cdn.jsdelivr.net/npm/jspdf@latest/dist/jspdf.umd.min.js"></script>
</head>
<body>

  <div class="theme-toggle" onclick="toggleTheme()">
    <div class="slider"></div>
    <span style="font-size:0.8rem;margin-left:4px;color:var(--text-muted);">D</span>
    <span style="font-size:0.8rem;margin-left:28px;color:var(--text-muted);">H</span>
  </div>

  <nav class="sidebar">
    <div class="sidebar-header">FamHealth Hub</div>
    <div class="sidebar-item" onclick="history.back()">← Zurück zur Akte</div>
  </nav>

  <main class="main">
    <h1 class="page-title">Neue Untersuchung – Akute Erkältung</h1>
    <p><strong>Patientin:</strong> Lena · 8 Jahre · 05.12.2025</p>

    <div style="background:var(--surface); padding:2rem; border-radius:8px; border:1px solid var(--border); max-width:900px;">
      <label>Datum/Uhrzeit</label>
      <input type="datetime-local" id="exam-date" value="2025-12-05T09:14">

      <label style="margin-top:1.5rem;display:block;">Fieberhöhe</label>
      <input type="number" step="0.1" id="temp" placeholder="z.B. 38.5"> °C

      <label style="margin-top:1.5rem;display:block;">Husten</label>
      <select id="husten">
        <option>trocken / Reizhusten</option>
        <option>produktiv</option>
        <option>kein Husten</option>
      </select>

      <label style="margin-top:1.5rem;display:block;">Rachen</label>
      <select id="rachen">
        <option>unauffällig</option>
        <option>gerötet</option>
        <option>Beläge / Exsudat</option>
      </select>

      <label style="margin-top:1.5rem;display:block;">Lunge auskultiert</label>
      <select id="lunge">
        <option>vesikulär, kein RG</option>
        <option>Giemen</option>
        <option>feuchte RG</option>
      </select>

      <label style="margin-top:1.5rem;display:block;">Schnelltest</label>
      <select id="test">
        <option>negativ</option>
        <option>Influenza A positiv</option>
        <option>RSV positiv</option>
        <option>Strep A positiv</option>
      </select>

      <label style="margin-top:1.5rem;display:block;">Therapie / AU</label>
      <textarea id="therapie" rows="4" placeholder="z.B. Ibuprofen 10 ml bei Fieber >38,5°C, viel trinken, AU bis 10.12."></textarea>

      <button id="save-pdf-btn" style="margin-top:2rem; padding:1rem 2rem; background:var(--primary); color:white; border:none; border-radius:6px; font-size:1.2rem;">
        PDF generieren & speichern
      </button>
    </div>
  </main>

  <script>
    const { jsPDF } = window.jspdf;

    document.getElementById('save-pdf-btn').onclick = () => {
      const doc = new jsPDF();
      let y = 20;

      // Briefkopf
      doc.setFontSize(18);
      doc.text("Hausarztbrief – Akute Erkältung", 20, y); y += 10;
      doc.setFontSize(12);
      doc.text(`Patientin: Lena, 8 Jahre`, 20, y); y += 8;
      doc.text(`Datum: ${document.getElementById('exam-date').value}`, 20, y); y += 12;

      doc.text("Befund:", 20, y); y += 8;
      doc.text(`Fieber: ${document.getElementById('temp').value || '-'} °C`, 30, y); y += 7;
      doc.text(`Husten: ${document.getElementById('husten').value}`, 30, y); y += 7;
      doc.text(`Rachen: ${document.getElementById('rachen').value}`, 30, y); y += 7;
      doc.text(`Lunge: ${document.getElementById('lunge').value}`, 30, y); y += 7;
      doc.text(`Test: ${document.getElementById('test').value}`, 30, y); y += 12;

      doc.text("Therapie / Empfehlung:", 20, y); y += 8;
      doc.text(document.getElementById('therapie').value || "symptomatisch", 30, y, {maxWidth: 150});

      doc.setFontSize(10);
      doc.text("Dr. med. [Dein Name]", 20, 270);

      doc.save(`Lena_Erkältung_${new Date().toISOString().slice(0,10)}.pdf`);
      alert("PDF gespeichert! (später kommt automatischer Speicher in Akte)");
    };

    // Theme wie immer
    const s = localStorage.getItem('theme') || 'dark';
    document.documentElement.setAttribute('data-theme', s);
    function toggleTheme(){/* wie vorher */ const c=document.documentElement.getAttribute('data-theme'); const n=c==='light'?'dark':'light'; document.documentElement.setAttribute('data-theme',n); localStorage.setItem('theme',n); }
  </script>
</body>
</html>